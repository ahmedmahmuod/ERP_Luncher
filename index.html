<!doctype html>
<html lang="en" class="sl-theme-light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ERP Launcher</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
      rel="stylesheet"
    />

    <!-- Custom Styles -->
    <link rel="stylesheet" href="/src/renderer/styles/tokens.css" />
    <link rel="stylesheet" href="/src/renderer/styles/app.css" />
    <link rel="stylesheet" href="/src/renderer/styles/modal-fix.css" />
  </head>
  <body>
    <!-- Custom Title Bar -->
    <div class="titlebar">
      <div class="titlebar-content">
        <img
          src="/src/assets/logo.png"
          alt="Logo"
          class="titlebar-logo"
          style="width: 24px; height: 24px; object-fit: contain"
        />
        <span class="titlebar-title">ERP LAUNCHER</span>
      </div>
      <div class="titlebar-controls">
        <sl-button id="minimize-btn" variant="text" size="small" class="titlebar-btn">
          <sl-icon name="dash-lg"></sl-icon>
        </sl-button>
        <sl-button id="maximize-btn" variant="text" size="small" class="titlebar-btn">
          <sl-icon name="app"></sl-icon>
        </sl-button>
        <sl-button id="close-btn" variant="text" size="small" class="titlebar-btn close-btn">
          <sl-icon name="x-lg"></sl-icon>
        </sl-button>
      </div>
    </div>

    <!-- Main Dashboard Layout -->
    <div class="main-layout">
      <!-- Left Sidebar (Nav) -->
      <aside class="sidebar">
        <div class="sidebar-content scrollbar-custom">
          <div>
            <h2 class="sidebar-section-title">Navigation</h2>
          </div>

          <nav class="sidebar-nav">
            <button class="nav-item active">
              <sl-icon name="grid"></sl-icon>
              <span class="sidebar-text">Dashboard</span>
            </button>
            <button class="nav-item">
              <sl-icon name="gear"></sl-icon>
              <span class="sidebar-text">Settings</span>
            </button>
          </nav>

          <div style="margin-top: var(--space-8)">
            <h2 class="sidebar-section-title">Categories</h2>
            <div id="category-list" class="sidebar-nav">
              <!-- Categories will be rendered here -->
            </div>
          </div>
        </div>

        <div class="sidebar-footer">
          <sl-button id="add-solution-btn" variant="primary" class="w-full" style="width: 100%">
            <sl-icon slot="prefix" name="plus-lg"></sl-icon>
            <span class="sidebar-text">Add Solution</span>
          </sl-button>
        </div>
      </aside>

      <!-- Center Content (Grid + Toolbar) -->
      <main class="main-content">
        <!-- Top Toolbar -->
        <header class="topbar">
          <div class="topbar-search">
            <sl-input id="search-input" placeholder="Search solutions..." clearable style="flex: 1">
              <sl-icon name="search" slot="prefix"></sl-icon>
            </sl-input>

            <sl-select id="category-filter" placeholder="All Categories" style="width: 12rem">
              <sl-option value="all">All Categories</sl-option>
            </sl-select>
          </div>

          <div class="topbar-actions">
            <sl-button id="run-all-btn" variant="success" size="medium" outline>
              <sl-icon slot="prefix" name="play-fill"></sl-icon>
              Run All
            </sl-button>
            <sl-button id="stop-all-btn" variant="danger" size="medium" outline>
              <sl-icon slot="prefix" name="stop-fill"></sl-icon>
              Stop All
            </sl-button>
            <sl-divider vertical style="height: 1.5rem; margin: 0 var(--space-2)"></sl-divider>
            <sl-tooltip content="Toggle Logs">
              <sl-button id="toggle-logs-btn" variant="default" size="medium" outline circle>
                <sl-icon name="terminal"></sl-icon>
              </sl-button>
            </sl-tooltip>
          </div>
        </header>

        <!-- Solution Grid Area -->
        <div class="content-area scrollbar-custom">
          <div id="solutions-grid" class="solutions-grid">
            <!-- Cards will be injected by TS -->
          </div>
        </div>
      </main>

      <!-- Right Resizable Logs Panel -->
      <aside id="logs-panel" class="logs-panel hidden">
        <!-- Resize Handle -->
        <div id="resize-handle" class="resize-handle"></div>

        <div class="logs-header">
          <div class="logs-title">
            <sl-icon name="terminal-fill" class="logs-title-icon"></sl-icon>
            <h3 class="logs-title-text">Live Logs</h3>
          </div>
          <div class="logs-controls">
            <sl-select id="log-filter" size="small" style="width: 10rem">
              <sl-option value="all">All Logs</sl-option>
            </sl-select>
            <sl-button id="clear-logs-btn" size="small" variant="text">
              <sl-icon name="trash"></sl-icon>
            </sl-button>
            <sl-button id="close-logs-btn" size="small" variant="text">
              <sl-icon name="x-lg"></sl-icon>
            </sl-button>
          </div>
        </div>

        <div id="logs-content" class="logs-content scrollbar-custom">
          <!-- Logs injected by TS -->
        </div>

        <div class="logs-footer">
          <span id="log-stats">0 lines</span>
          <sl-checkbox id="auto-scroll-check" size="small" checked>Auto-scroll</sl-checkbox>
        </div>
      </aside>
    </div>

    <!-- Modals -->
    <sl-dialog id="solution-modal" label="Solution Editor">
      <form id="solution-form" style="display: flex; flex-direction: column; gap: var(--space-4)">
        <sl-input
          label="Service Name"
          id="solution-name"
          required
          placeholder="e.g. ERP Shell"
        ></sl-input>

        <div style="display: flex; flex-direction: column; gap: var(--space-1)">
          <label
            style="
              font-size: var(--text-sm);
              font-weight: var(--font-medium);
              color: var(--text);
              margin-left: var(--space-1);
            "
            >Repository path</label
          >
          <div style="display: flex; gap: var(--space-2)">
            <sl-input
              id="solution-path"
              required
              placeholder="C:\projects\..."
              style="flex: 1"
            ></sl-input>
            <sl-button id="browse-path-btn">Browse</sl-button>
          </div>
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-4)">
          <sl-input
            label="Command"
            id="solution-command"
            required
            placeholder="npm"
            value="npm"
          ></sl-input>
          <sl-input label="Arguments" id="solution-args" placeholder="run,dev"></sl-input>
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-4)">
          <sl-input label="Port" id="solution-port" type="number" required value="4200"></sl-input>
          <sl-input label="Category" id="solution-category" required value="Frontend"></sl-input>
        </div>

        <sl-input
          label="Health URL"
          id="solution-url"
          placeholder="http://localhost:4200"
        ></sl-input>

        <sl-checkbox id="solution-autostart">Launch on startup</sl-checkbox>

        <div slot="footer" style="display: flex; gap: var(--space-2); justify-content: flex-end">
          <sl-button variant="text" id="cancel-modal-btn">Cancel</sl-button>
          <sl-button variant="primary" type="submit">Save Solution</sl-button>
        </div>
      </form>
    </sl-dialog>

    <!-- Global Toast Container -->
    <div
      id="toast-container"
      style="
        position: fixed;
        bottom: var(--space-4);
        right: var(--space-4);
        z-index: var(--z-tooltip);
        display: flex;
        flex-direction: column;
        gap: var(--space-2);
        pointer-events: none;
      "
    ></div>

    <script type="module" src="/src/renderer/renderer.ts"></script>
  </body>
</html>
